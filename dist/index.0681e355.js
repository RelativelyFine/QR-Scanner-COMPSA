const qrcodeBtn=window.qrcode,video=document.createElement("video"),canvasElement=document.getElementById("qr-canvas"),canvas=canvasElement.getContext("2d"),qrResult=document.getElementById("qr-result"),outputData=document.getElementById("outputData"),btnScanQR=document.getElementById("btn-scan-qr"),backButton=document.getElementById("backButton"),error=document.getElementById("error"),errorData=document.getElementById("errorData");let scanning=!1;qrcodeBtn.callback=async e=>{await closeQR(e)},backButton.onclick=async e=>{await closeQR(e)};const closeQR=async e=>{e&&(scanning=!1,video.srcObject.getTracks().forEach((e=>{e.stop()})),"click"==e.type?outputData.innerText="Scan Cancelled!":(outputData.innerText=e,await backendInterface(e)),qrResult.hidden=!1,backButton.hidden=!0,canvasElement.hidden=!0,btnScanQR.hidden=!1)};function tick(){canvasElement.height=video.videoHeight,canvasElement.width=video.videoWidth,canvas.drawImage(video,0,0,canvasElement.width,canvasElement.height),scanning&&requestAnimationFrame(tick)}function scan(){try{qrcode.decode()}catch(e){setTimeout(scan,300)}}async function backendInterface(e){net_id=await JSON.parse(e).net_id,award_id=await document.getElementById("award-id").value,url=`https://compsa.ca/api/admin/manage?net_id=${net_id}&award_id=${award_id}`,await fetch(url).then((e=>{console.log(e),error.hidden=!0,errorData.innerText=""})).catch((e=>{console.log(e),error.hidden=!1,errorData.innerText=e}))}btnScanQR.onclick=()=>{navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then((function(e){backButton.hidden=!1,scanning=!0,qrResult.hidden=!0,btnScanQR.hidden=!0,canvasElement.hidden=!1,video.setAttribute("playsinline",!0),video.srcObject=e,video.play(),tick(),scan()}))};
//# sourceMappingURL=index.0681e355.js.map
